const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Files-DVgrhEq0.js","assets/index-6DHakvZj.js","assets/index-C7fQORYj.css","assets/Files-C-RNb_QE.css","assets/Schedule-Dspm8M7F.js","assets/schedule-DamagGMV.js","assets/Schedule-BhI5sr-m.css","assets/Approval-CbE75HTA.js","assets/Approval-JBqpChOJ.css","assets/AnnouncementManager-tGDv1rlj.js","assets/notice-BIvWqKNf.js","assets/AnnouncementManager-BUbjLEDD.css","assets/Votes-BqijwmNg.js","assets/Votes-IFiUZhMk.css","assets/Feedback-9xv-BAIM.js","assets/Feedback-B8I-lzrM.css"])))=>i.map(i=>d[i]);
import{O as x,_ as wt,c as oe,A as kt,r as m,o as bt,B as ht,W as Ct,P as i,b as p,e as v,f as l,t as g,w as o,p as N,g as $,ac as O,C as ge,i as f,h as u,M as Vt,F as S,k as P,N as Dt,n as T,d as ae,Q as ne,x as xt,ad as F,ae as At,y as d,D as Tt,S as fe,X as Et,af as $t}from"./index-6DHakvZj.js";import{g as Lt,a as Ut,d as Kt,u as Te,c as Mt,e as zt,f as Bt,h as It}from"./knowledge-D986d23K.js";const Ht=()=>x.get("/admin/users"),Rt=(k,re=!0)=>x.put(`/admin/users/${k}/ban`,{ban:re}),Ot=k=>x.delete(`/admin/users/${k}`),St=k=>x.get(`/admin/users/${k}/docs`),Pt=()=>x.get("/admin/tasks"),Ft=k=>x.post("/admin/monitor/docs",{keywords:k}),Yt=()=>x.get("/admin/backup/export",{responseType:"blob"}),jt=k=>x.post("/admin/backup/import",k,{headers:{"Content-Type":"multipart/form-data"}}),Ee=()=>x.get("/admin/monitor/keywords"),Nt=k=>x.post("/admin/monitor/keywords",{keyword:k}),qt=k=>x.delete(`/admin/monitor/keywords/${k}`),Qt={class:"admin-dashboard"},Jt={class:"page-title"},Wt={key:0},Xt={key:1},Zt={class:"toolbar",style:{"justify-content":"space-between"}},Gt={key:0,style:{padding:"40px 0"}},el={key:1,class:"user-tasks-container"},tl={class:"user-header"},ll={class:"user-info"},ol={class:"username"},al={class:"task-count"},nl={key:0},rl={key:1,style:{color:"var(--el-text-color-placeholder)"}},sl={key:2},il={class:"toolbar"},dl={key:0,class:"keyword-list"},ul={style:{"min-height":"200px"}},cl={key:0},pl={class:"preview-header"},vl={class:"preview-meta"},ml={style:{"margin-top":"8px"}},yl=["innerHTML"],gl={key:3},fl={class:"toolbar",style:{"margin-bottom":"16px"}},_l={class:"category-tabs-wrapper"},wl=["onDragstart","onDragover","onDrop"],kl={class:"category-name"},bl={key:0,class:"article-preview"},hl={class:"article-info"},Cl={class:"author"},Vl={class:"time"},Dl=["innerHTML"],xl={key:4},Al={key:5,style:{height:"600px"}},Tl={key:6,style:{height:"600px"}},El={key:7},$l={key:8},Ll={class:"toolbar"},Ul={key:9},Kl={key:10},Ml={class:"toolbar"},zl={__name:"AdminDashboard",setup(k){const re=O(()=>F(()=>import("./Files-DVgrhEq0.js"),__vite__mapDeps([0,1,2,3]))),$e=O(()=>F(()=>import("./Schedule-Dspm8M7F.js"),__vite__mapDeps([4,1,2,5,6]))),Le=O(()=>F(()=>import("./Approval-CbE75HTA.js"),__vite__mapDeps([7,1,2,8]))),Ue=O(()=>F(()=>import("./AnnouncementManager-tGDv1rlj.js"),__vite__mapDeps([9,10,1,2,11]))),Ke=O(()=>F(()=>import("./Votes-BqijwmNg.js"),__vite__mapDeps([12,1,2,10,13]))),Me=O(()=>F(()=>import("./Feedback-9xv-BAIM.js"),__vite__mapDeps([14,1,2,15]))),ze=kt(),Be=xt(),w=oe(()=>ze.params.tab||"announcement"),Ie={announcement:"公告管理",kanban:"工作流程看板",monitor:"文档监控",knowledge:"知识库",files:"文件中心",schedule:"日程与会议",approval:"审批流",vote:"投票与问卷",users:"用户管理",feedback:"留言与反馈",backup:"系统级备份与恢复"},He=oe(()=>Ie[w.value]||"管理员后台"),M=m([]),q=m(!1),Q=m(""),se=m(!1),_e=m([]),J=m([]),W=m(!1),X=m(""),C=m([]),Z=m(!1),L=m(null),z=m([]),E=m("all"),ie=m([]),G=m(!1),B=m(!1),V=m({name:""}),Y=m(!1),_=m({id:null,title:"",content:"",category_id:null}),j=m(!1),D=m(null);let h=null;const I=m(null),we=m(null),Re=oe(()=>{if(!Q.value)return M.value;const t=Q.value.toLowerCase();return M.value.filter(e=>e.username.toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t))}),Oe=oe(()=>z.value.reduce((t,e)=>t+e.article_count,0));bt(()=>{w.value==="users"&&de(),w.value==="kanban"&&pe(),w.value==="knowledge"&&(U(),H()),w.value==="monitor"&&ke()}),ht(()=>{h&&(h.destroy(),h=null)}),Ct(w,t=>{t==="users"&&M.value.length===0&&de(),t==="kanban"&&pe(),t==="knowledge"&&(U(),H()),t==="monitor"&&ke()});const de=async()=>{var t,e;q.value=!0;try{const n=await Ht();M.value=n}catch(n){i.error(((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.msg)||"加载用户失败")}finally{q.value=!1}},ue=m([]),ce=m(!1),pe=async()=>{ce.value=!0;try{const t=await Pt();ue.value=t}catch(t){console.error("获取所有用户任务失败",t),i.error("获取任务列表失败")}finally{ce.value=!1}},Se=t=>({High:"danger",Medium:"warning",Low:"info"})[t]||"info",Pe=t=>ae().isAfter(ae(t)),Fe=async t=>{var e,n;try{const r=await St(t.id);_e.value=r,se.value=!0}catch(r){i.error(((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.msg)||"获取用户文档失败")}},Ye=async t=>{var e,n;try{const r=t.status==="normal";await Rt(t.id,r),t.status=r?"banned":"normal",t.role=r?"banned":"user",i.success(r?"已封禁用户":"已解封用户")}catch(r){i.error(((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.msg)||"操作失败")}},je=t=>{ne.confirm(`确认删除用户 ${t.username} 吗？此操作不可恢复。`,"警告",{type:"warning"}).then(async()=>{var e,n;try{await Ot(t.id),M.value=M.value.filter(r=>r.id!==t.id),i.success("用户已删除")}catch(r){i.error(((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.msg)||"删除失败")}}).catch(()=>{})},ke=async()=>{try{const t=await Ee();C.value=t.map(e=>e.keyword)}catch(t){console.error("加载监控关键词失败",t)}},be=async()=>{var e,n;const t=X.value.trim();if(!t){i.warning("请输入关键词");return}if(C.value.includes(t)){i.warning("关键词已存在");return}try{await Nt(t),C.value.push(t),X.value="",i.success("添加成功")}catch(r){i.error(((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.msg)||"添加失败")}},Ne=async t=>{const e=C.value[t];try{const r=(await Ee()).find(y=>y.keyword===e);r&&(await qt(r.id),C.value.splice(t,1),C.value.length===0&&(J.value=[]),i.success("删除成功"))}catch{i.error("删除失败")}},qe=async()=>{if(C.value.length===0){i.warning("请至少添加一个关键词");return}W.value=!0;try{const t=await Ft(C.value);J.value=t,i.success(`搜索完成，找到 ${t.length} 个包含关键词的文档`)}catch(t){console.error("搜索文档失败",t),i.error("搜索失败，请重试")}finally{W.value=!1}},Qe=t=>{L.value=t,Z.value=!0},ve=m(!1),Je=async()=>{ve.value=!0;try{const t=await Yt();if(t.type==="application/json"){const r=new FileReader;r.onload=()=>{let y="导出失败";try{y=JSON.parse(r.result).msg||y}catch{}i.error(y)},r.readAsText(t);return}const e=window.URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.href=e,n.setAttribute("download",`system_backup_${ae().format("YYYYMMDDHHmmss")}.sql`),document.body.appendChild(n),n.click(),document.body.removeChild(n),i.success("备份下载成功")}catch(t){console.error(t),i.error("导出失败")}finally{ve.value=!1}},We=async t=>{ne.confirm("确定要导入备份吗？这将覆盖当前所有数据且不可恢复！","高风险操作警告",{type:"warning",confirmButtonText:"确定覆盖",cancelButtonText:"取消"}).then(async()=>{var n,r;const e=At.service({text:"正在恢复数据，请勿关闭页面...",background:"rgba(0,0,0,0.7)"});try{const y=new FormData;y.append("file",t.file),await jt(y),e.close(),i.success("恢复成功，系统即将刷新"),setTimeout(()=>{window.location.reload()},1500)}catch(y){e.close(),console.error(y),i.error(((r=(n=y.response)==null?void 0:n.data)==null?void 0:r.msg)||"恢复失败")}}).catch(()=>{})},U=async()=>{try{const t=await Lt();z.value=t}catch(t){console.error("加载分类失败",t)}},H=async()=>{G.value=!0;try{const t=E.value==="all"?null:parseInt(E.value),e=await Ut(t);ie.value=e}catch(t){console.error("加载文章失败",t),i.error("加载文章失败")}finally{G.value=!1}},Xe=()=>{H()},Ze=()=>{V.value={id:null,name:""},B.value=!0},Ge=t=>{V.value={id:t.id,name:t.name},B.value=!0},et=async()=>{if(!V.value.name){i.warning("请输入分类名称");return}try{V.value.id?(await Te(V.value.id,{name:V.value.name}),i.success("更新成功")):(await Mt(V.value),i.success("添加成功")),B.value=!1,U()}catch{i.error(V.value.id?"更新失败":"添加失败")}},tt=t=>{ne.confirm(`确定删除分类"${t.name}"吗？该分类下的所有文章也将被删除。`,"警告",{type:"warning"}).then(async()=>{try{await It(t.id),i.success("删除成功"),U(),E.value===String(t.id)&&(E.value="all"),H()}catch{i.error("删除失败")}}).catch(()=>{})},lt=(t,e)=>{I.value=t,e.dataTransfer.effectAllowed="move",e.target.style.opacity="0.5"},ot=(t,e)=>{we.value=t},at=async(t,e)=>{if(e.preventDefault(),I.value===null||I.value===t)return;const n=[...z.value],r=n[I.value];n.splice(I.value,1),n.splice(t,0,r);const y=n.map((s,b)=>({id:s.id,order:b}));z.value=n.map((s,b)=>({...s,order:b}));try{for(const s of y)await Te(s.id,{order:s.order});i.success("分类顺序已更新")}catch(s){console.error("更新顺序失败",s),i.error("更新顺序失败"),U()}},nt=t=>{t.target.style.opacity="1",I.value=null,we.value=null},me=(t=null)=>{t?_.value={id:t.id,title:t.title,content:t.content||"",category_id:t.category_id}:_.value={id:null,title:"",content:"",category_id:E.value==="all"?null:parseInt(E.value)},Y.value=!0,setTimeout(()=>{rt()},100)},rt=()=>{if(h&&(h.destroy(),h=null),typeof window.wangEditor>"u"){console.error("wangEditor 未加载");return}const{createEditor:t,createToolbar:e}=window.wangEditor,n=document.getElementById("knowledge-editor");if(!n)return;n.innerHTML="";const r=document.createElement("div");r.id="knowledge-toolbar",r.style.border="1px solid var(--el-border-color-light)",r.style.borderRadius="4px 4px 0 0";const y=document.createElement("div");y.id="knowledge-editor-content",y.style.border="1px solid var(--el-border-color-light)",y.style.borderTop="none",y.style.borderRadius="0 0 4px 4px",y.style.minHeight="400px",y.style.maxHeight="500px",y.style.overflowY="auto",n.appendChild(r),n.appendChild(y);const s={placeholder:"请输入文章内容...",onChange(K){_.value.content=K.getHtml()}};h=t({selector:"#knowledge-editor-content",html:_.value.content||"",config:s,mode:"default"}),e({editor:h,selector:"#knowledge-toolbar",config:{toolbarKeys:["headerSelect","bold","italic","underline","through","|","bulletedList","numberedList","|","color","bgColor","|","fontSize","fontFamily","|","justifyLeft","justifyCenter","justifyRight","|","insertLink","uploadImage","insertTable","|","codeBlock","blockquote","|","undo","redo","clearStyle"]},mode:"default"})},st=()=>{if(h){try{h.destroy()}catch(t){console.error("销毁编辑器失败",t)}h=null}},it=async()=>{if(!_.value.title){i.warning("请输入文章标题");return}if(!_.value.category_id){i.warning("请选择所属分类");return}h&&(_.value.content=h.getHtml());try{const t={title:_.value.title,content:_.value.content,category_id:_.value.category_id};_.value.id?(await zt(_.value.id,t),i.success("更新成功")):(await Bt(t),i.success("创建成功")),Y.value=!1,H(),U()}catch{i.error(_.value.id?"更新失败":"创建失败")}},dt=t=>{D.value=t,j.value=!0},ut=t=>{ne.confirm(`确定删除文章"${t.title}"吗？`,"警告",{type:"warning"}).then(async()=>{try{await Kt(t.id),i.success("删除成功"),H(),U()}catch{i.error("删除失败")}}).catch(()=>{})},ct=()=>{D.value&&(j.value=!1,me(D.value))},pt=()=>{if(D.value){const{href:t}=Be.resolve({name:"knowledge-article",params:{id:D.value.id}});window.open(t,"_blank")}},vt=t=>ae(t).format("YYYY-MM-DD HH:mm:ss");return(t,e)=>{const n=f("el-button"),r=f("el-empty"),y=f("el-avatar"),s=f("el-table-column"),b=f("el-tag"),K=f("el-table"),he=f("el-card"),ee=f("el-input"),Ce=f("el-divider"),te=f("el-dialog"),Ve=f("el-tab-pane"),De=f("el-icon"),mt=f("el-tabs"),le=f("el-form-item"),xe=f("el-form"),Ae=f("el-option"),yt=f("el-select"),gt=f("el-upload"),ft=f("el-alert"),_t=f("el-drawer"),ye=Vt("loading");return d(),p("div",Qt,[v("h2",Jt,g(He.value),1),l(he,{class:"card"},{default:o(()=>{var R;return[w.value==="announcement"?(d(),p("div",Wt,[l($(Ue))])):w.value==="kanban"?(d(),p("div",Xt,[v("div",Zt,[e[17]||(e[17]=v("span",{class:"hint"},"监控所有用户的待处理和进行中任务（按用户名排序）",-1)),l(n,{type:"primary",link:"",onClick:pe},{default:o(()=>[...e[16]||(e[16]=[u("刷新",-1)])]),_:1})]),ge((d(),p("div",null,[ue.value.length===0?(d(),p("div",Gt,[l(r,{description:"暂无活动任务"})])):(d(),p("div",el,[(d(!0),p(S,null,P(ue.value,a=>(d(),T(he,{key:a.user_id,class:"user-task-card",shadow:"hover"},{header:o(()=>[v("div",tl,[l(y,{size:40,src:a.avatar},{default:o(()=>[u(g(a.username.charAt(0).toUpperCase()),1)]),_:2},1032,["src"]),v("div",ll,[v("div",ol,g(a.username),1),v("div",al,g(a.tasks.length)+" 个活动任务",1)])])]),default:o(()=>[l(K,{data:a.tasks,style:{width:"100%"},size:"small"},{default:o(()=>[l(s,{prop:"title",label:"任务标题","min-width":"150","show-overflow-tooltip":""}),l(s,{prop:"notes",label:"备注","min-width":"120","show-overflow-tooltip":"",align:"center"},{default:o(c=>[c.row.notes?(d(),p("span",nl,g(c.row.notes),1)):(d(),p("span",rl,"-"))]),_:1}),l(s,{prop:"status",label:"状态",width:"100",align:"center"},{default:o(c=>[l(b,{type:c.row.status==="in-progress"?"":"warning",size:"small"},{default:o(()=>[u(g(c.row.status==="in-progress"?"进行中":"待处理"),1)]),_:2},1032,["type"])]),_:1}),l(s,{prop:"priority",label:"优先级",width:"100",align:"center"},{default:o(c=>[l(b,{type:Se(c.row.priority),effect:"plain",size:"small"},{default:o(()=>[u(g(c.row.priority),1)]),_:2},1032,["type"])]),_:1}),l(s,{prop:"deadline",label:"截止时间",width:"160",align:"center"},{default:o(c=>[v("span",{class:Tt({"text-danger":Pe(c.row.deadline)})},g(c.row.deadline),3)]),_:1})]),_:1},8,["data"])]),_:2},1024))),128))]))])),[[ye,ce.value]])])):w.value==="monitor"?(d(),p("div",sl,[v("div",il,[l(ee,{modelValue:X.value,"onUpdate:modelValue":e[0]||(e[0]=a=>X.value=a),placeholder:"输入监控关键词",style:{width:"240px"},clearable:"",onKeyup:Dt(be,["enter"])},null,8,["modelValue"]),l(n,{type:"primary",onClick:be},{default:o(()=>[...e[18]||(e[18]=[u("添加关键词",-1)])]),_:1}),l(n,{type:"success",onClick:qe,loading:W.value,disabled:C.value.length===0},{default:o(()=>[...e[19]||(e[19]=[u("搜索文档",-1)])]),_:1},8,["loading","disabled"]),C.value.length?(d(),p("div",dl,[e[20]||(e[20]=v("span",{style:{"margin-right":"8px",color:"var(--el-text-color-secondary)"}},"关键词：",-1)),(d(!0),p(S,null,P(C.value,(a,c)=>(d(),T(b,{key:c,closable:"",onClose:A=>Ne(c),style:{"margin-right":"8px"}},{default:o(()=>[u(g(a),1)]),_:2},1032,["onClose"]))),128))])):N("",!0)]),ge((d(),p("div",ul,[J.value.length>0?(d(),T(K,{key:0,data:J.value,style:{width:"100%"},border:""},{default:o(()=>[l(s,{prop:"title",label:"文档标题","min-width":"180","show-overflow-tooltip":""}),l(s,{prop:"username",label:"创建用户",width:"120",align:"center"}),l(s,{prop:"matched_keywords",label:"匹配关键词",width:"150",align:"center"},{default:o(a=>[(d(!0),p(S,null,P(a.row.matched_keywords,(c,A)=>(d(),T(b,{key:A,size:"small",type:"danger",style:{margin:"2px"}},{default:o(()=>[u(g(c),1)]),_:2},1024))),128))]),_:1}),l(s,{prop:"snippet",label:"内容片段","min-width":"200","show-overflow-tooltip":""}),l(s,{prop:"updated_at",label:"更新时间",width:"160",align:"center"}),l(s,{label:"操作",width:"120",align:"center"},{default:o(a=>[l(n,{size:"small",type:"primary",link:"",onClick:c=>Qe(a.row)},{default:o(()=>[...e[21]||(e[21]=[u("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(d(),T(r,{key:1,description:"请添加关键词并点击搜索"}))])),[[ye,W.value]]),l(te,{modelValue:Z.value,"onUpdate:modelValue":e[2]||(e[2]=a=>Z.value=a),title:"文档预览",width:"70%",top:"5vh","destroy-on-close":""},{footer:o(()=>[l(n,{type:"primary",onClick:e[1]||(e[1]=a=>Z.value=!1)},{default:o(()=>[...e[23]||(e[23]=[u("关闭",-1)])]),_:1})]),default:o(()=>[L.value?(d(),p("div",cl,[v("div",pl,[v("h3",null,g(L.value.title),1),v("div",vl,[l(b,{size:"small"},{default:o(()=>[u("创建用户："+g(L.value.username),1)]),_:1}),l(b,{size:"small",type:"info",style:{"margin-left":"8px"}},{default:o(()=>[u("更新时间："+g(L.value.updated_at),1)]),_:1}),v("div",ml,[e[22]||(e[22]=v("span",{style:{"margin-right":"8px"}},"匹配关键词：",-1)),(d(!0),p(S,null,P(L.value.matched_keywords,(a,c)=>(d(),T(b,{key:c,size:"small",type:"danger",style:{"margin-right":"4px"}},{default:o(()=>[u(g(a),1)]),_:2},1024))),128))])])]),l(Ce),v("div",{class:"preview-content",innerHTML:L.value.content},null,8,yl)])):N("",!0)]),_:1},8,["modelValue"])])):w.value==="knowledge"?(d(),p("div",gl,[v("div",fl,[l(n,{type:"primary",onClick:Ze},{default:o(()=>[...e[24]||(e[24]=[u("添加分类",-1)])]),_:1}),l(n,{type:"success",onClick:e[3]||(e[3]=a=>me())},{default:o(()=>[...e[25]||(e[25]=[u("新建文章",-1)])]),_:1})]),v("div",_l,[l(mt,{modelValue:E.value,"onUpdate:modelValue":e[4]||(e[4]=a=>E.value=a),onTabChange:Xe},{default:o(()=>[l(Ve,{label:`全部 (${Oe.value})`,name:"all"},null,8,["label"]),(d(!0),p(S,null,P(z.value,(a,c)=>(d(),T(Ve,{key:a.id,label:`${a.name} (${a.article_count})`,name:String(a.id)},{label:o(()=>[v("div",{class:"category-tab-label",draggable:"true",onDragstart:A=>lt(c,A),onDragover:fe(A=>ot(c,A),["prevent"]),onDrop:A=>at(c,A),onDragend:nt},[l(De,{class:"edit-category-icon",onClick:fe(A=>Ge(a),["stop"]),title:"编辑分类"},{default:o(()=>[l($(Et))]),_:1},8,["onClick"]),v("span",kl,g(a.name)+" ("+g(a.article_count)+")",1),l(De,{class:"delete-category-icon",onClick:fe(A=>tt(a),["stop"]),title:"删除分类"},{default:o(()=>[l($($t))]),_:1},8,["onClick"])],40,wl)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),ge((d(),p("div",null,[l(K,{data:ie.value,style:{width:"100%"},border:""},{default:o(()=>[l(s,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),l(s,{prop:"category_name",label:"分类",width:"120",align:"center"}),l(s,{prop:"author",label:"作者",width:"100",align:"center"}),l(s,{prop:"updated_at",label:"更新时间",width:"160",align:"center"}),l(s,{label:"操作",width:"180",align:"center"},{default:o(a=>[l(n,{size:"small",type:"primary",link:"",onClick:c=>dt(a.row)},{default:o(()=>[...e[26]||(e[26]=[u("预览",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:"warning",link:"",onClick:c=>me(a.row)},{default:o(()=>[...e[27]||(e[27]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:"danger",link:"",onClick:c=>ut(a.row)},{default:o(()=>[...e[28]||(e[28]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),ie.value.length===0&&!G.value?(d(),T(r,{key:0,description:"暂无文章"})):N("",!0)])),[[ye,G.value]]),l(te,{modelValue:B.value,"onUpdate:modelValue":e[7]||(e[7]=a=>B.value=a),title:"添加分类",width:"400px"},{footer:o(()=>[l(n,{onClick:e[6]||(e[6]=a=>B.value=!1)},{default:o(()=>[...e[29]||(e[29]=[u("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:et},{default:o(()=>[...e[30]||(e[30]=[u("确定",-1)])]),_:1})]),default:o(()=>[l(xe,{model:V.value,"label-width":"80px"},{default:o(()=>[l(le,{label:"分类名称"},{default:o(()=>[l(ee,{modelValue:V.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>V.value.name=a),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(te,{modelValue:Y.value,"onUpdate:modelValue":e[11]||(e[11]=a=>Y.value=a),title:_.value.id?"编辑文章":"新建文章",width:"80%",top:"5vh","destroy-on-close":"",onClosed:st},{footer:o(()=>[l(n,{onClick:e[10]||(e[10]=a=>Y.value=!1)},{default:o(()=>[...e[32]||(e[32]=[u("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:it},{default:o(()=>[...e[33]||(e[33]=[u("保存",-1)])]),_:1})]),default:o(()=>[l(xe,{model:_.value,"label-width":"80px"},{default:o(()=>[l(le,{label:"文章标题"},{default:o(()=>[l(ee,{modelValue:_.value.title,"onUpdate:modelValue":e[8]||(e[8]=a=>_.value.title=a),placeholder:"请输入文章标题"},null,8,["modelValue"])]),_:1}),l(le,{label:"所属分类"},{default:o(()=>[l(yt,{modelValue:_.value.category_id,"onUpdate:modelValue":e[9]||(e[9]=a=>_.value.category_id=a),placeholder:"请选择分类",style:{width:"100%"}},{default:o(()=>[l(Ae,{label:"未分类",value:null}),(d(!0),p(S,null,P(z.value,a=>(d(),T(Ae,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(le,{label:"文章内容"},{default:o(()=>[...e[31]||(e[31]=[v("div",{id:"knowledge-editor",class:"knowledge-editor-wrapper"},null,-1)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(te,{modelValue:j.value,"onUpdate:modelValue":e[13]||(e[13]=a=>j.value=a),title:(R=D.value)==null?void 0:R.title,width:"70%",top:"5vh"},{footer:o(()=>[l(n,{onClick:e[12]||(e[12]=a=>j.value=!1)},{default:o(()=>[...e[34]||(e[34]=[u("关闭",-1)])]),_:1}),l(n,{type:"success",onClick:pt},{default:o(()=>[...e[35]||(e[35]=[u("新标签页打开",-1)])]),_:1}),l(n,{type:"primary",onClick:ct},{default:o(()=>[...e[36]||(e[36]=[u("编辑",-1)])]),_:1})]),default:o(()=>[D.value?(d(),p("div",bl,[v("div",hl,[l(b,{size:"small"},{default:o(()=>[u(g(D.value.category_name),1)]),_:1}),v("span",Cl,"作者："+g(D.value.author),1),v("span",Vl,"更新时间："+g(D.value.updated_at),1)]),l(Ce),v("div",{class:"article-content",innerHTML:D.value.content},null,8,Dl)])):N("",!0)]),_:1},8,["modelValue","title"])])):w.value==="files"?(d(),p("div",xl,[l($(re),{embedded:!0})])):w.value==="schedule"?(d(),p("div",Al,[l($($e))])):w.value==="approval"?(d(),p("div",Tl,[l($(Le))])):w.value==="vote"?(d(),p("div",El,[l($(Ke))])):w.value==="users"?(d(),p("div",$l,[v("div",Ll,[l(ee,{modelValue:Q.value,"onUpdate:modelValue":e[14]||(e[14]=a=>Q.value=a),placeholder:"搜索用户名/邮箱",style:{width:"240px"},clearable:""},null,8,["modelValue"]),l(n,{loading:q.value,onClick:de},{default:o(()=>[...e[37]||(e[37]=[u("刷新",-1)])]),_:1},8,["loading"])]),l(K,{data:Re.value,style:{width:"100%"},border:"",loading:q.value},{default:o(()=>[l(s,{prop:"username",label:"用户名",width:"140"}),l(s,{prop:"email",label:"邮箱"}),l(s,{prop:"department",label:"部门",width:"120"}),l(s,{prop:"role",label:"角色",width:"100"}),l(s,{prop:"status",label:"状态",width:"100"},{default:o(a=>[l(b,{type:a.row.status==="normal"?"success":"danger"},{default:o(()=>[u(g(a.row.status==="normal"?"正常":"已封禁"),1)]),_:2},1032,["type"])]),_:1}),l(s,{label:"操作",width:"260"},{default:o(a=>[l(n,{size:"small",onClick:c=>Fe(a.row)},{default:o(()=>[...e[38]||(e[38]=[u("查看文档",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:a.row.status==="normal"?"danger":"success",onClick:c=>Ye(a.row)},{default:o(()=>[u(g(a.row.status==="normal"?"封禁":"解封"),1)]),_:2},1032,["type","onClick"]),l(n,{size:"small",type:"danger",onClick:c=>je(a.row)},{default:o(()=>[...e[39]||(e[39]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading"])])):w.value==="feedback"?(d(),p("div",Ul,[l($(Me))])):w.value==="backup"?(d(),p("div",Kl,[v("div",Ml,[l(n,{type:"primary",loading:ve.value,onClick:Je},{default:o(()=>[...e[40]||(e[40]=[u("导出全量备份",-1)])]),_:1},8,["loading"]),l(gt,{class:"upload-backup",action:"#","http-request":We,"show-file-list":!1,accept:".sql",style:{display:"inline-block","margin-left":"12px","margin-right":"12px"}},{default:o(()=>[l(n,{type:"success"},{default:o(()=>[...e[41]||(e[41]=[u("导入备份文件",-1)])]),_:1})]),_:1}),e[42]||(e[42]=v("span",{class:"hint"},"用于管理员备份与恢复整个数据库。请谨慎操作，恢复将覆盖现有数据！",-1))]),l(ft,{title:"操作提示",type:"info",closable:!1,"show-icon":""},{default:o(()=>[...e[43]||(e[43]=[u(" 导出操作将下载当前系统所有数据的SQL文件。导入操作将清除当前数据库并应用上传的SQL文件，此过程不可逆。 ",-1)])]),_:1})])):N("",!0)]}),_:1}),l(_t,{modelValue:se.value,"onUpdate:modelValue":e[15]||(e[15]=R=>se.value=R),size:"40%",title:"用户文档预览"},{default:o(()=>[l(K,{data:_e.value,style:{width:"100%"},border:""},{default:o(()=>[l(s,{prop:"title",label:"标题"}),l(s,{prop:"folder",label:"文件夹",width:"140"}),l(s,{prop:"updated_at",label:"更新时间",width:"200"},{default:o(R=>[u(g(vt(R.row.updated_at)),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}},Hl=wt(zl,[["__scopeId","data-v-e00649ed"]]);export{Hl as default};

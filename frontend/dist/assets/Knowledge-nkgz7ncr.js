import{_ as U,r as u,c as P,o as R,b as _,e as o,f as a,C as j,w as n,i as r,F as x,k as A,M as q,n as y,p as M,h as d,t as i,P as G,x as J,y as c,g as N,a2 as O,a3 as Q}from"./index-6DHakvZj.js";import{g as W,a as X}from"./knowledge-D986d23K.js";const Y={class:"knowledge-page"},Z={class:"article-list"},ee={class:"article-header"},te={class:"article-meta"},le={key:0,class:"article-preview"},ae={class:"article-info"},oe={class:"author"},ne={class:"time"},se=["innerHTML"],re={__name:"Knowledge",setup(ce){const T=J(),v=u("all"),g=u([]),f=u([]),p=u(!1),m=u(!1),s=u(null),$=P(()=>g.value.reduce((l,e)=>l+e.article_count,0)),B=async()=>{try{const l=await W();g.value=l}catch(l){console.error("加载分类失败",l)}},h=async()=>{p.value=!0;try{const l=v.value==="all"?null:parseInt(v.value),e=await X(l);f.value=e}catch(l){console.error("加载文章失败",l),G.error("加载文章失败")}finally{p.value=!1}},I=()=>{h()},D=l=>{s.value=l,m.value=!0},L=()=>{if(s.value){const{href:l}=T.resolve({name:"knowledge-article",params:{id:s.value.id}});window.open(l,"_blank")}};return R(()=>{B(),h()}),(l,e)=>{var V;const w=r("el-tab-pane"),z=r("el-tabs"),b=r("el-tag"),k=r("el-icon"),E=r("el-card"),F=r("el-empty"),H=r("el-divider"),C=r("el-button"),K=r("el-dialog"),S=q("loading");return c(),_("div",Y,[e[5]||(e[5]=o("div",{class:"page-header"},[o("h2",null,"知识库")],-1)),a(z,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),onTabChange:I},{default:n(()=>[a(w,{label:`全部 (${$.value})`,name:"all"},null,8,["label"]),(c(!0),_(x,null,A(g.value,t=>(c(),y(w,{key:t.id,label:`${t.name} (${t.article_count})`,name:String(t.id)},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),j((c(),_("div",Z,[(c(!0),_(x,null,A(f.value,t=>(c(),y(E,{key:t.id,class:"article-card",shadow:"hover",onClick:ie=>D(t)},{default:n(()=>[o("div",ee,[o("h3",null,i(t.title),1),a(b,{size:"small",type:"info"},{default:n(()=>[d(i(t.category_name),1)]),_:2},1024)]),o("div",te,[o("span",null,[a(k,null,{default:n(()=>[a(N(O))]),_:1}),d(" "+i(t.author),1)]),o("span",null,[a(k,null,{default:n(()=>[a(N(Q))]),_:1}),d(" "+i(t.updated_at),1)])])]),_:2},1032,["onClick"]))),128)),f.value.length===0&&!p.value?(c(),y(F,{key:0,description:"暂无文章"})):M("",!0)])),[[S,p.value]]),a(K,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),title:(V=s.value)==null?void 0:V.title,width:"70%",top:"5vh","destroy-on-close":""},{footer:n(()=>[a(C,{onClick:e[1]||(e[1]=t=>m.value=!1)},{default:n(()=>[...e[3]||(e[3]=[d("关闭",-1)])]),_:1}),a(C,{type:"primary",onClick:L},{default:n(()=>[...e[4]||(e[4]=[d("新标签页打开",-1)])]),_:1})]),default:n(()=>[s.value?(c(),_("div",le,[o("div",ae,[a(b,{size:"small"},{default:n(()=>[d(i(s.value.category_name),1)]),_:1}),o("span",oe,"作者："+i(s.value.author),1),o("span",ne,"更新时间："+i(s.value.updated_at),1)]),a(H),o("div",{class:"article-content",innerHTML:s.value.content},null,8,se)])):M("",!0)]),_:1},8,["modelValue","title"])])}}},_e=U(re,[["__scopeId","data-v-93b87918"]]);export{_e as default};
